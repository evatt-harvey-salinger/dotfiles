# ~/.tmux.conf

# --- Terminal Configuration ---
# Set the default terminal type for tmux itself.
# "tmux-256color" enables 256 color support within tmux sessions.
set -g default-terminal "tmux-256color"
# Append to global terminal overrides. This line specifically enables RGB (true color)
# support for terminals that identify as "xterm-256color" when interacting with tmux.
set -ag terminal-overrides ",xterm-256color:RGB"

# --- Prefix Key ---
# Set the global prefix key to Ctrl+a. This is the key combination you press
# before any tmux command.
set -g prefix C-a
# Unbind the default prefix Ctrl+b, as we've set it to Ctrl+a.
unbind C-b
# Allow sending the actual Ctrl+a character to applications (e.g., if you need to use
# Ctrl+a within a program running in tmux) by pressing the prefix (Ctrl+a) twice.
bind-key C-a send-prefix

# --- Window Splitting ---
# Unbind the default key for splitting the window horizontally (%).
unbind %
# Bind '|' (pipe) to split the current window horizontally (creating a new pane to the right).
# The '-h' flag stands for horizontal.
bind | split-window -h

# Unbind the default key for splitting the window vertically (").
unbind '"'
# Bind '-' (hyphen/minus) to split the current window vertically (creating a new pane below).
# The '-v' flag stands for vertical.
bind - split-window -v

# --- Reloading Configuration ---
# Unbind the default 'r' key (often used for force-redraw in some contexts).
unbind r
# Bind 'r' (after pressing the prefix) to reload the tmux configuration file (~/.tmux.conf).
# This allows you to apply changes without restarting tmux.
bind r source-file ~/.tmux.conf

# --- Pane Resizing (using prefix + key) ---
# Bind 'j' (prefix + j) to resize the current pane Down by 5 cells.
bind j resize-pane -D 5
# Bind 'k' (prefix + k) to resize the current pane Up by 5 cells.
bind k resize-pane -U 5
# Bind 'l' (prefix + l) to resize the current pane Right by 5 cells.
bind l resize-pane -R 5
# Bind 'h' (prefix + h) to resize the current pane Left by 5 cells.
bind h resize-pane -L 5

# --- Pane Zooming ---
# Bind 'm' (prefix + m) to toggle zoom for the current pane (maximize/unmaximize).
# The '-r' flag makes the key repeatable for a short time, so you can press
# prefix, then 'm', then 'm' again quickly without another prefix if needed,
# though for a toggle, it's usually pressed once.
bind -r m resize-pane -Z

# --- Mouse Support ---
# Enable mouse support. This allows you to select panes, windows, resize panes,
# and scroll using the mouse.
set -g mouse on

# --- Copy Mode Keybindings (Vi-style) ---
# Set vi keybindings for copy mode (and other modes like choice mode).
# This means you can use vi-like keys (h, j, k, l, etc.) to navigate in copy mode.
set-window-option -g mode-keys vi

# When in vi copy mode, bind 'v' to start text selection (like visual mode in Vim).
bind-key -T copy-mode-vi 'v' send -X begin-selection
# When in vi copy mode, bind 'y' to copy the selected text to the tmux paste buffer.
bind-key -T copy-mode-vi 'y' send -X copy-selection

# Prevent tmux from exiting copy mode when a mouse drag selection (MouseDragEnd1Pane) ends.
# This allows you to make a selection with the mouse and then, for example, press 'y' to copy.
unbind -T copy-mode-vi MouseDragEnd1Pane

# --- Support for image.nvim ---
set -gq allow-passthrough on
set -g visual-activity on

# --- Performance / Responsiveness ---
# Reduce the delay tmux waits for an escape sequence after the Esc key is pressed.
# Default is 500ms. Setting it to 10ms makes escaping insert mode in Neovim (or Vim)
# feel much more responsive when running inside tmux.
# '-s' applies to server-wide options, '-g' to global session options.
set -sg escape-time 10

set -g base-index 1
set -g renumber-windows on

# --- TPM (Tmux Plugin Manager) ---
# Declare the TPM plugin itself. This line is necessary for TPM to work.
set -g @plugin 'tmux-plugins/tpm'

# --- List of Tmux Plugins (Managed by TPM) ---
# Plugin for seamless navigation between Vim/Neovim splits and tmux panes
# using common directional keys (Ctrl+h/j/k/l by default).
set -g @plugin 'christoomey/vim-tmux-navigator'
# Plugin to persist tmux sessions (windows, panes, arrangements) after a computer restart.
# You can restore sessions manually.
set -g @plugin 'tmux-plugins/tmux-resurrect'
# Plugin that works with tmux-resurrect to automatically save your tmux sessions
# periodically (default is every 15 minutes) and auto-restore on tmux start.
set -g @plugin 'tmux-plugins/tmux-continuum'
# A Tokyo Night theme for tmux status bar and other elements.
# set -g @plugin 'fabioluciano/tmux-tokyo-night'
set -g @plugin 'catppuccin/tmux'

# --- Plugin Options ---
# Configure tmux-resurrect to also save and restore the contents of panes (e.g., command output).
set -g @resurrect-capture-pane-contents 'on'
# Configure tmux-continuum to automatically restore the last saved session when tmux starts.
set -g @continuum-restore 'on'

# --- Initialize TMUX Plugin Manager ---
# This line runs the TPM script, which loads the plugins defined above.
# IMPORTANT: This line must be at the very bottom of your tmux.conf file.
run '~/.tmux/plugins/tpm/tpm'
